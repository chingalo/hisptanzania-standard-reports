<!--<script src="jquery.min.js"></script>-->
<!--<link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.css">-->
<link rel="stylesheet" type="text/css" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.12/css/dataTables.bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/tabletools/2.2.2/css/dataTables.tableTools.min.css">
<script type="text/javascript" charset="utf-8" src="https://code.jquery.com/jquery-1.12.3.js"></script>
<script type="text/javascript" charset="utf-8" src="https://cdn.datatables.net/1.10.12/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" charset="utf-8" src="https://cdnjs.cloudflare.com/ajax/libs/zeroclipboard/2.2.0/ZeroClipboard.min.js"></script>
<script type="text/javascript" charset="utf-8" src="https://cdn.datatables.net/tabletools/2.2.2/js/dataTables.tableTools.min.js"></script>
<script type="text/javascript" charset="utf-8" src="https://cdn.datatables.net/1.10.12/js/dataTables.bootstrap.min.js"></script>
<script>
    $(document).ready(function () {
        $(".loader").hide();
        $(".header").hide();
        var html = "";
        var dataElems = "";
        var dataElems1 = "";
        var dateElmsArr = [];
        var targetsArr = [];
        var dateElmsArr1 = [];
        var url = "";
        var orgUnit = dhis2.report.organisationUnit;
        var periods = dhis2.report.periods;
        var periodNames = getThreeMonthName(periods[0])
        $("#orgUnits").html(orgUnit.name)
        var data = getDataElements();
        $.each(data, function (key, value) {
            if (value.hasOwnProperty('content')) {
                $.each(value.content, function (k, val) {
                    if (val.hasOwnProperty('indicator')) {
                        if (val.hasOwnProperty('rows')) {
                            $.each(val.defination, function (j, v) {
                                if (v.hasOwnProperty('id')) {
                                    if (v.id != "") {
                                        if (dateElmsArr.indexOf(v.id) == -1) {
                                            dateElmsArr.push(v.id);
                                        }

                                    }
                                }
                                if (v.hasOwnProperty('targett')) {
                                    if (v.targett != "") {
                                        if (targetsArr.indexOf(v.targett) == -1) {
                                            targetsArr.push(v.targett);
                                        }

                                    }
                                }
                            });
                        }
                    }
                });
            }
        });
        var period = getThreeMonth(periods[0]);

        function loadData(level, cordId) {
            html = "";
            $('table').html("");
            html += "<tr>";
            html += '<th style="width: 1%">#</th>';
            html += '<th style="width: 25%">Outcome</th>';
            html += '<th style="width: 25%">Performance Indicator</th>';
            $.each(periodNames.split(";"), function (m, per) {
                html += "<th style='width: 10%'>" + per + "</th>"
            });
            html += '<th style="width: 10%">Realisation</th>';
            html += '<th style="width: 5%">Target</th>';
            html += '<th style="width: 5%">Achievement</th>';
            html += "</tr>";
            orgunitsArr = [];
            $.getJSON("/api/organisationUnitGroups/Ke5RMquBtP8.json?fields=name,organisationUnits", function (
                org) {
                $.each(org.organisationUnits, function (key, value) {
                    orgunitsArr.push(value.id)
                });
                var url = "/api/analytics.json?dimension=dx:" + dateElmsArr.join(";") +
                    "&dimension=pe:" + period + "&filter=ou:" + orgunitsArr.join(";") +
                    "&displayProperty=NAME";
                var url1 = "/api/analytics.json?dimension=dx:" + targetsArr.join(";") +
                    "&dimension=pe:" + periods[0] + "&filter=ou:" + orgUnit.id +
                    "&displayProperty=NAME";
                $(".loader").show("slow");
                $(".header").hide();
                $.getJSON(url, function (resp) {
                    $.getJSON(url1, function (resp1) {
                        $.each(data, function (key, value) {
                            html += "<tr style='background-color: " + value.color +
                                "'><td colspan='9'>" + value.title +
                                "</td> </tr>";
                            if (value.hasOwnProperty('content')) {
                                $.each(value.content, function (k, val) {

                                    if (val.hasOwnProperty('indicator')) {
                                        if (val.hasOwnProperty('rows')) {
                                            var valuee1 = [];
                                            var sumvaluee1 = 0;
                                            var valuee2 = [];
                                            var sumvaluee2 = 0;
                                            html += "<tr>";
                                            html += "<td rowspan='" +
                                                val.rows + "'></td>";
                                            html += "<td rowspan='" +
                                                val.rows + "'>" + val.indicator +
                                                "</td>";
                                            html += "<td>" + val.defination[
                                                0].term + "</td>";
                                            if (val.hasOwnProperty(
                                                    'defination')) {
                                                if (val.defination[0].hasOwnProperty(
                                                        'id')) {
                                                    $.each(period.split(
                                                            ";"),
                                                        function (m,
                                                            per) {
                                                            valuee1
                                                                [
                                                                    per
                                                                ] =
                                                                getDataFromUrl1(
                                                                    resp
                                                                    .rows,
                                                                    per,
                                                                    val
                                                                    .defination[
                                                                        0
                                                                    ]
                                                                    .id
                                                                );
                                                            html +=
                                                                "<td>" +
                                                                valuee1[
                                                                    per
                                                                ] +
                                                                "</td>";
                                                            sumvaluee1
                                                                +=
                                                                valuee1[
                                                                    per
                                                                ];
                                                        })
                                                }
                                            }
                                            //realization
                                            if (val.defination[0].realisation ==
                                                'sum') {
                                                html += "<td>" +
                                                    sumvaluee1 +
                                                    "</td>";
                                            } else if (val.defination[0]
                                                .realisation == 'last') {
                                                html += "<td>" +
                                                    valuee1[2] +
                                                    "</td>";
                                            }

                                            html += "<td>" +
                                                getDataFromUrl(resp1.rows,
                                                    periods[0], val.defination[
                                                        0].targett);
                                            "+</td>";

                                            html +=
                                                "<td  class='lastColumn'></td>";

                                            html += "</tr>";
                                            var rowTracker = 0;
                                            $.each(val.defination,
                                                function (j, v) {
                                                    if (rowTracker ==
                                                        0) {

                                                    } else {
                                                        html +=
                                                            "<tr>";
                                                        html +=
                                                            "<td>" +
                                                            v.term +
                                                            "</td>";
                                                        if (v.hasOwnProperty(
                                                                'id'
                                                            )) {

                                                            $.each(
                                                                period
                                                                .split(
                                                                    ";"
                                                                ),
                                                                function (
                                                                    m,
                                                                    per
                                                                ) {
                                                                    valuee2
                                                                        [
                                                                            per
                                                                        ] =
                                                                        getDataFromUrl1(
                                                                            resp
                                                                            .rows,
                                                                            per,
                                                                            v
                                                                            .id
                                                                        );
                                                                    html
                                                                        +=
                                                                        "<td>" +
                                                                        valuee2[
                                                                            per
                                                                        ] +
                                                                        "</td>";
                                                                    sumvaluee2
                                                                        +=
                                                                        valuee2[
                                                                            per
                                                                        ];
                                                                }
                                                            )
                                                        }

                                                        //realization
                                                        if (v.realisation ==
                                                            'sum') {
                                                            html +=
                                                                "<td>" +
                                                                sumvaluee2 +
                                                                "</td>";
                                                        } else if (
                                                            v.realisation ==
                                                            'last') {
                                                            html +=
                                                                "<td>" +
                                                                valuee1[
                                                                    2
                                                                ] +
                                                                "</td>";
                                                        } else if (
                                                            v.realisation ==
                                                            'avg') {

                                                            var summ =
                                                                (
                                                                    sumvaluee2 ==
                                                                    0
                                                                ) ?
                                                                0 :
                                                                (
                                                                    sumvaluee1 /
                                                                    sumvaluee2
                                                                ) *
                                                                100;
                                                            html +=
                                                                "<td>" +
                                                                summ
                                                                .toFixed(
                                                                    1
                                                                ) +
                                                                "</td>";
                                                        }

                                                        html +=
                                                            "<td>" +
                                                            getDataFromUrl(
                                                                resp1
                                                                .rows,
                                                                periods[
                                                                    0
                                                                ],
                                                                v.targett
                                                            );
                                                        "+</td>";

                                                        html +=
                                                            "<td  class='lastColumn'></td>";
                                                        html +=
                                                            "</tr>";
                                                    }
                                                    rowTracker++
                                                });
                                        }


                                    }


                                });
                            }
                        });
                        $("table").append(html);
                        $('.lastColumn').each(function () {
                            //processing this row
                            var num = $(this).prev('td').text();
                            var num1 = $(this).prev('td').prev('td').text();
                            num = num.replace(",", "");
                            if (num != '0') {
                                if ($.isNumeric(parseInt(num1))) {
                                    var parc = (parseInt(num1) * 100) /
                                        parseInt(num);
                                    if (parc < 41) {
                                        $(this).text(parseInt(parc)).css(
                                            'background', '#FF0000')
                                    } else if (parc > 41 && parc < 81) {
                                        $(this).text(parseInt(parc)).css(
                                            'background', '#FFFF00')
                                    } else if (parc > 80) {
                                        $(this).text(parseInt(parc)).css(
                                            'background', '#92D050')
                                    }
                                    $(this).text(parseInt(parc))
                                } else {
                                    $(this).text('').css('background',
                                        '#E6DADA')
                                }

                            }
                        });
                        $('.listTable').addClass(
                            'bordered-table zebra-striped dataTable');
                        var periodName = getPeroidName(periods[0]);

                        $(".orgUnit").html(orgUnit.name);
                        $(".period").html(periodName);
                        $(".loader").hide();
                        $(".header").show();
                    });
                });
            });

        }

        loadData('national', 'riuabH1sYe6');
    });

    function pushPeriodOneStep(period) {
        var year = period.substring(0, 4);
        var quater = period.substring(4, 6);
        var time = "";
        var names = "";
        if (quater == "Q4") {
            var yr = parseInt(year) + 1;
            time = yr + "Q1";
        } else if (quater == "Q3") {
            time = year + "Q4";
        } else if (quater == "Q2") {
            time = year + "Q3";
        } else if (quater == "Q1") {
            time = year + "Q2";
        }
        return period;
    }

    function getThreeMonth(period) {
        var year = period.substring(0, 4);
        var quater = period.substring(4, 6);
        var nextYear = parseInt(year) + 1;
        var time = year + "Q4;" + nextYear + "Q1;" + nextYear + "Q2;" + nextYear + "Q3";
        return time;
    }

    function getThreeMonthName(period) {
        var year = period.substring(0, 4);
        var nextyear = parseInt(year) + 1;
        var quater = period.substring(4, 6);
        var time = "";
        names = "Oct - Dec " + year + ";Jan - Mar " + nextyear + ";Apr - Jun " + nextyear + ";July - Sept " + nextyear;

        return names;
    }

    function getPeroidName(period) {
        var year = period.substring(0, 4);
        var quater = period.substring(4, 6);
        var time = "";
        var names = year

        return names;
    }

    function getDataFromUrl(arr, pe, de) {
        var num = 0
        $.each(arr, function (k, v) {
            if (v[0] == de && v[1] == pe) {
                num = parseInt(v[2])
            }
        });
        return num;
    }

    function getDataFromUrl1(arr, pe, de) {
        var num = 0
        $.each(arr, function (k, v) {
            if (v[0] == de && v[1] == pe) {
                num = parseInt(v[2])
            }
        });
        return num;
    }


    function getDataElements() {
        var data = [{
            "title": "Project Goal: Increase healthy spacing of pregnancies among women of reproductive age, especially those aged 15-24 in Shinyanga Region",
            "color": "#D6E3BC",
            "content": [{
                "indicator": "Increase in CYP (disaggregated by method) in project area",
                "rows": "1",
                "num": "",
                "defination": [{
                    "term": "Total target CYP+",
                    "id": "PMPE2EDE001",
                    "realisation": "sum",
                    "targett": "PMPE2ETG001"
                }]
            }, {
                "indicator": "CYP contribution by CHW",
                "rows": "8",
                "num": "3",
                "defination": [{
                    "term": "CYP - Condoms ",
                    "id": "qdrFaOoDnze",
                    "realisation": "sum",
                    "targett": "qdrFaOoDnze"
                }, {
                    "term": "CYP - Pills by CHW",
                    "id": "frfsHECWlKG",
                    "realisation": "sum",
                    "targett": "frfsHECWlKG"
                }, {
                    "term": "CYP- Injectable referrals completed",
                    "id": "PMPE2EDE004",
                    "realisation": "sum",
                    "targett": "PMPE2ETG004"
                }, {
                    "term": "CYP-Implant referrals completed",
                    "id": "PMPE2EDE005",
                    "realisation": "sum",
                    "targett": "PMPE2ETG005"
                }, {
                    "term": "CYP-IUD referrals",
                    "id": "PMPE2EDE006",
                    "realisation": "sum",
                    "targett": "PMPE2ETG006"
                }, {
                    "term": "CYP-Tubulagation referrals completed",
                    "id": "PMPE2EDE007",
                    "realisation": "sum",
                    "targett": "PMPE2ETG007"
                }, {
                    "term": "CYP-Vasectomy referrals completed",
                    "id": "PMPE2EDE008",
                    "realisation": "sum",
                    "targett": "PMPE2ETG008"
                }, {
                    "term": "Total CYP by CHW",
                    "id": "PMPE2EDE009",
                    "realisation": "sum",
                    "targett": "PMPE2ETG009"
                }]
            }, {
                "indicator": "CYP contribution from facilites  and outreach service",
                "rows": "9",
                "num": "3",
                "defination": [{
                    "term": "CYP - Condoms",
                    "id": "C7X8xkHjsXo",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "CYP - Pills",
                    "id": "Jjya4RxmJhT",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "CYP - Injectables",
                    "id": "FPszf08yAVk",
                    "realisation": "sum",
                    "targett": "PMPE2ETG010"
                }, {
                    "term": "CYP - Implanon",
                    "id": "b3A8AvDs3ZY",
                    "realisation": "sum",
                    "targett": "PMPE2ETG011"
                }, {
                    "term": "CYP - Jadelle",
                    "id": "KO9vdzgRXbf",
                    "realisation": "sum",
                    "targett": "PMPE2ETG012"
                }, {
                    "term": "CYP - Intrauterine Contraceptive Device (IUD) ",
                    "id": "kq9N0loL906",
                    "realisation": "sum",
                    "targett": "PMPE2ETG013"
                }, {
                    "term": "CYP - Tubal Ligation",
                    "id": "yi3C16pYffx",
                    "realisation": "sum",
                    "targett": "PMPE2ETG014"
                }, {
                    "term": "CYP - Vasectomies",
                    "id": "iUcrTVinoKD",
                    "realisation": "sum",
                    "targett": "PMPE2ETG015"
                }, {
                    "term": "Total CYP by  Facility",
                    "id": "PMPMMHDE008",
                    "realisation": "sum",
                    "targett": "PMPE2ETG016"
                }]
            }]
        }, {
            "title": "Project Goal: Increase healthy spacing of pregnancies among women of reproductive age, especially those aged 15-24 in Shinyanga Region",
            "color": "#D6E3BC",
            "content": [{
                "indicator": "1.1.  Number of WRA provided with contraceptive methods by  CHW by type",
                "rows": "5",
                "num": "3",
                "defination": [{
                    "term": "Total target new users ",
                    "id": "PMPMMHDE009",
                    "realisation": "sum",
                    "targett": "PMPE2ETG017"
                }, {
                    "term": "Female Condoms",
                    "id": "PMPMMHDE010",
                    "realisation": "sum",
                    "targett": "PMPE2ETG018"
                }, {
                    "term": "Male Condoms",
                    "id": "PMPMMHDE010",
                    "realisation": "sum",
                    "targett": "PMPE2ETG019"
                }, {
                    "term": "POP",
                    "id": "PMPMMHDE010",
                    "realisation": "sum",
                    "targett": "PMPE2ETG020"
                }, {
                    "term": "COC",
                    "id": "PMPMMHDE010",
                    "realisation": "sum",
                    "targett": "PMPE2ETG021"
                }]
            }, {
                "indicator": "1.2. Number of WRA provided with counseling on SRH/ FP by CHW, disaggregated by  age  (10-14, 15-19, 20-24) ",
                "rows": "5",
                "num": "3",
                "defination": [{
                    "term": "Total target",
                    "id": "PMPMMHDE011",
                    "realisation": "sum",
                    "targett": "PMPE2ETG022"
                }, {
                    "term": "10-14",
                    "id": "PMPMMHDE011",
                    "realisation": "sum",
                    "targett": "PMPE2ETG023"
                }, {
                    "term": "15-19",
                    "id": "PMPMMHDE011",
                    "realisation": "sum",
                    "targett": "PMPE2ETG024"
                }, {
                    "term": "20-24",
                    "id": "PMPMMHDE011",
                    "realisation": "sum",
                    "targett": "PMPE2ETG025"
                }, {
                    "term": "25+",
                    "id": "PMPMMHDE011",
                    "realisation": "sum",
                    "targett": "PMPE2ETG026"
                }]
            }, {
                "indicator": "1.3. Number of repeat WRA clients in the community by method",
                "rows": "5",
                "num": "3",
                "defination": [{
                    "term": "Total WRA  target revisits",
                    "id": "PMPMMHDE012",
                    "realisation": "sum",
                    "targett": "PMPE2ETG027"
                }, {
                    "term": "Female Condomsy",
                    "id": "PMPMMHDE013",
                    "realisation": "sum",
                    "targett": "PMPE2ETG028"
                }, {
                    "term": "Male Condoms",
                    "id": "PMPMMHDE014",
                    "realisation": "sum",
                    "targett": "PMPE2ETG029"
                }, {
                    "term": "POP",
                    "id": "PMPMMHDE014",
                    "realisation": "sum",
                    "targett": "PMPE2ETG030"
                }, {
                    "term": "COC",
                    "id": "PMPMMHDE014",
                    "realisation": "sum",
                    "targett": "PMPE2ETG031"
                }]
            }, {
                "indicator": "1.3b. Number of contraceptives given out  by CHW",
                "rows": "2",
                "num": "3",
                "defination": [{
                    "term": "Condoms",
                    "id": "PMPMMHDE012",
                    "realisation": "sum",
                    "targett": "PMPE2ETG032"
                }, {
                    "term": "Pills",
                    "id": "PMPMMHDE013",
                    "realisation": "sum",
                    "targett": "PMPE2ETG033"
                }]
            }, {
                "indicator": "1.4. Number of referrals made by CHW for contraceptive methods  by method",
                "rows": "6",
                "num": "3",
                "defination": [{
                    "term": "Total Targets",
                    "id": "PMPMMHDE012",
                    "realisation": "sum",
                    "targett": "PMPE2ETG034"
                }, {
                    "term": "Injectable",
                    "id": "PMPMMHDE013",
                    "realisation": "sum",
                    "targett": "PMPE2ETG035"
                }, {
                    "term": "Implants",
                    "id": "PMPMMHDE014",
                    "realisation": "sum",
                    "targett": "PMPE2ETG036"
                }, {
                    "term": "IUD",
                    "id": "PMPMMHDE014",
                    "realisation": "sum",
                    "targett": "PMPE2ETG037"
                }, {
                    "term": "Female Sterilization",
                    "id": "PMPMMHDE014",
                    "realisation": "sum",
                    "targett": "PMPE2ETG038"
                }, {
                    "term": "Vasectomy",
                    "id": "PMPMMHDE014",
                    "realisation": "sum",
                    "targett": "PMPE2ETG039"
                }]
            }, {
                "indicator": "1.5. Number of clients who completed referrals made by CHW by method",
                "rows": "6",
                "num": "3",
                "defination": [{
                    "term": "Total Targets",
                    "id": "PMPE2EDE040",
                    "realisation": "sum",
                    "targett": "PMPE2ETG040"
                }, {
                    "term": "Injectable",
                    "id": "PMPE2EDE041",
                    "realisation": "sum",
                    "targett": "PMPE2ETG041"
                }, {
                    "term": "Implants",
                    "id": "PMPE2EDE042",
                    "realisation": "sum",
                    "targett": "PMPE2ETG042"
                }, {
                    "term": "IUD",
                    "id": "PMPE2EDE043",
                    "realisation": "sum",
                    "targett": "PMPE2ETG043"
                }, {
                    "term": "Female Sterilization",
                    "id": "PMPE2EDE044",
                    "realisation": "sum",
                    "targett": "PMPE2ETG044"
                }, {
                    "term": "Vasectomy",
                    "id": "PMPE2EDE045",
                    "realisation": "sum",
                    "targett": "PMPE2ETG045"
                }]
            }, {
                "indicator": "1.6. Number of facility-based providers trained to deliver LARC servicers",
                "rows": "1",
                "num": "3",
                "defination": [{
                    "term": "",
                    "id": "PMPE2EDE046",
                    "realisation": "sum",
                    "targett": "PMPE2ETG046"
                }]
            }, {
                "indicator": "1.7. New contraceptive users in the health facilities",
                "rows": "9",
                "num": "3",
                "defination": [{
                    "term": "Total Targets",
                    "id": "PMPE2EDE064",
                    "realisation": "sum",
                    "targett": "PMPE2ETG047"
                }, {
                    "term": "Oral Contraceptives",
                    "id": "QsG09ni0Vck",
                    "realisation": "sum",
                    "targett": "PMPE2ETG048"
                }, {
                    "term": "Male Condoms",
                    "id": "vrYUVlPjGHX",
                    "realisation": "sum",
                    "targett": "PMPE2ETG049"
                }, {
                    "term": "Female Condoms",
                    "id": "pK1gZxC2yzO",
                    "realisation": "sum",
                    "targett": "PMPE2ETG049"
                }, {
                    "term": "Injectable",
                    "id": "stUhpCLQHdo",
                    "realisation": "sum",
                    "targett": "PMPMMHTG014"
                }, {
                    "term": "Implants (Implanon NXT and Jadelle)",
                    "id": "F1jtqafoS9m",
                    "realisation": "sum",
                    "targett": "PMPE2ETG050"
                }, {
                    "term": "IUCDs",
                    "id": "cLGchHOHUPP",
                    "realisation": "sum",
                    "targett": "PMPE2ETG051"
                }, {
                    "term": "Female Sterilization",
                    "id": "V1tZJGfdeL6",
                    "realisation": "sum",
                    "targett": "PMPE2ETG052"
                }, {
                    "term": "Vasectomy",
                    "id": "v8X8GNnoX2M",
                    "realisation": "sum",
                    "targett": "PMPE2ETG053"
                }]
            }, {
                "indicator": "1.7.1. New contraceptive users Outreach",
                "rows": "9",
                "num": "3",
                "defination": [{
                    "term": "Total Targets",
                    "id": "PMPE2EDE064",
                    "realisation": "sum",
                    "targett": "PMPE2ETG047"
                }, {
                    "term": "Oral Contraceptives",
                    "id": "",
                    "realisation": "sum",
                    "targett": "PMPE2ETG048"
                }, {
                    "term": "Male Condoms",
                    "id": "",
                    "realisation": "sum",
                    "targett": "PMPE2ETG049"
                }, {
                    "term": "Female Condoms",
                    "id": "",
                    "realisation": "sum",
                    "targett": "PMPE2ETG049"
                }, {
                    "term": "Injectable",
                    "id": "",
                    "realisation": "sum",
                    "targett": "PMPMMHTG014"
                }, {
                    "term": "Implants (Implanon NXT and Jadelle)",
                    "id": "ZnTi99UdGCS",
                    "realisation": "sum",
                    "targett": "PMPE2ETG050"
                }, {
                    "term": "IUCDs",
                    "id": "RfSsrHPGBXV",
                    "realisation": "sum",
                    "targett": "PMPE2ETG051"
                }, {
                    "term": "Female Sterilization",
                    "id": "chmWn8ksICz",
                    "realisation": "sum",
                    "targett": "PMPE2ETG052"
                }, {
                    "term": "Vasectomy",
                    "id": "xip1SDutimh",
                    "realisation": "sum",
                    "targett": "PMPE2ETG053"
                }]
            }, {
                "indicator": "1.8. Number of new  FP users enrolled in the facilities by age",
                "rows": "5",
                "num": "3",
                "defination": [{
                    "term": "Total target",
                    "id": "PMPMMHDE011",
                    "realisation": "sum",
                    "targett": "PMPE2ETG054"
                }, {
                    "term": "10-14",
                    "id": "OIsWASIKhFI",
                    "realisation": "sum",
                    "targett": "PMPE2ETG055"
                }, {
                    "term": "15-19",
                    "id": "KHk45qgIUgx",
                    "realisation": "sum",
                    "targett": "PMPE2ETG056"
                }, {
                    "term": "20-24",
                    "id": "fMZMgRlUxYK",
                    "realisation": "sum",
                    "targett": "PMPE2ETG057"
                }, {
                    "term": "25+",
                    "id": "ya78GSsUFB5",
                    "realisation": "sum",
                    "targett": "PMPE2ETG058"
                }]
            }, {
                "indicator": "1.9: Number of revisit users in the health facilities",
                "rows": "4",
                "num": "3",
                "defination": [{
                    "term": "Male Condoms ",
                    "id": "PHN05p61ByJ.Zi6m8Bfd4YZ",
                    "realisation": "sum",
                    "targett": "PMPE2ETG059"
                }, {
                    "term": "Female Condoms ",
                    "id": "PMPMMHDE011",
                    "realisation": "sum",
                    "targett": "PMPE2ETG059"
                }, {
                    "term": "Pills",
                    "id": "PHN05p61ByJ.OVPV2za8nOf",
                    "realisation": "sum",
                    "targett": "PMPE2ETG060"
                }, {
                    "term": "Injectables",
                    "id": "epPM7fO8CnH.RcgnLQy1MxN",
                    "realisation": "sum",
                    "targett": "PMPE2ETG061"
                }]
            }, {
                "indicator": "1.2: Number of contraceptives distributed in health facilities",
                "rows": "2",
                "num": "3",
                "defination": [{
                    "term": "Condoms ",
                    "id": "oAdnR7jRTSN",
                    "realisation": "sum",
                    "targett": "PMPE2ETG062"
                }, {
                    "term": "Pills",
                    "id": "bjkeLqFDDjo",
                    "realisation": "sum",
                    "targett": "PMPE2ETG063"
                }]
            }, {
                "indicator": "1.21.Number of contraceptives distributed through outreach services",
                "rows": "2",
                "num": "3",
                "defination": [{
                    "term": "Condoms ",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "Pills",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }]
            }, {
                "indicator": "1..2.2 New contraceptive users  through community outreach services",
                "rows": "9",
                "num": "3",
                "defination": [{
                    "term": "Total",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "Condoms",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "Oral Contraceptives ",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "Injectable",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "Implanon NXT  ",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "Jadelle",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "IUCDs",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "Female Sterilization",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }, {
                    "term": "Vasectomy",
                    "id": "",
                    "realisation": "sum",
                    "targett": ""
                }]
            }]
        }, {
            "title": "Objective 2: Build the capacity of facilities such that they meet quality standards for providing comprehensive FP services, including LARC",
            "color": "#D6E3BC",
            "content": [{
                "indicator": "Output Indicators:",
                "rows": "4",
                "num": "3",
                "defination": [{
                    "term": "2.1: Number of facilities provided with FP supplies and equipment (by type of equipment)",
                    "id": "PMPE2EDE065",
                    "realisation": "sum",
                    "targett": "PMPE2ETG065"
                }, {
                    "term": "2.2: Number of  supportive supervision rounds conducted in health facilities  ",
                    "id": "PMPE2EDE066",
                    "realisation": "sum",
                    "targett": "PMPE2ETG066"
                }, {
                    "term": "2.3: Number of quarterly review meetings conducted  with CHMT ",
                    "id": "PMPE2EDE067",
                    "realisation": "sum",
                    "targett": "PMPE2ETG067"
                }]
            }]
        }];
        return data;
    }

    function download(name) {
        var uri = 'data:application/vnd.ms-excel;base64,',
            template =
            '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table border="1">{table}</table><br /><table border="1">{table}</table></body></html>',
            base64 = function (s) {
                return window.btoa(unescape(encodeURIComponent(s)));
            },
            format = function (s, c) {
                return s.replace(/{(\w+)}/g, function (m, p) {
                    return c[p];
                })
            };
        // console.log("Table:",nativeElement.innerHTML);
        var ctx = {
            worksheet: "Sheet 1"
        };
        var str =
            '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body>';
        var el = $(".listTable");
        ($(".listTable").find("td.hidden").each(function (index2) {
            // console.log("Remove Index:",index2);
            this.remove();
        }));
        ctx["table1"] = el.innerHTML;

        str += '<table border="1">{table1}</table><br />';
        str += '</body></html>';

        setTimeout(function () {

            var link = document.createElement('a');
            link.download = name + ".xlsx";
            link.href = uri + base64(format(str, ctx));
            link.click();
        }, 100);
    }
</script>
<h4 class="loader"><img src="/images/ajax-loader-circle.gif"> Loading data ...</h4>
<!--<button class="btn bt-small btn-default" onclick="download('report')">Download Excel</button>-->
<h3 class="header text-center">Bergstrom PMP Report - <span class="period"></span> - <span id="orgUnits"> </span></h3>
<div class="col-sm-10 col-sm-offset-1">
    <table class="listTable table table-bordered table-responsive">
        <thead class="header">

        </thead>
    </table>
</div>